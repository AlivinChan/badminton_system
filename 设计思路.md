# 校园羽毛球馆场地预约管理系统 - 设计思路

## 一、系统概述

本系统是一个基于Java面向对象程序设计思想开发的校园羽毛球馆场地预约管理系统。系统采用分层架构设计，实现了学生预约场地、管理员管理场地、预约状态管理等核心功能。

## 二、系统架构设计

### 2.1 分层架构

系统采用经典的三层架构模式：

1. **实体层（Entity Layer）**
   - 负责定义系统中的所有实体类
   - 包含：Student（学生）、Admin（管理员）、Court（场地）、Reservation（预约）

2. **数据访问层（DAO Layer）**
   - 负责数据的持久化存储和读取
   - DataManager类采用单例模式，统一管理所有数据操作
   - 使用JSON格式存储数据，便于数据迁移和查看

3. **业务逻辑层（Service Layer）**
   - 负责处理业务逻辑和规则验证
   - 包含：UserService（用户服务）、ReservationService（预约服务）、CourtService（场地服务）

4. **表示层（UI Layer）**
   - 负责用户交互界面
   - 提供两种界面：ConsoleUI（控制台界面）和SwingUI（图形界面）

### 2.2 核心类设计

#### 实体类设计

1. **Student（学生类）**
   - 属性：学号（studentId）、姓名（name）、联系电话（phone）
   - 功能：存储学生基本信息

2. **Admin（管理员类）**
   - 属性：工号（adminId）、姓名（name）、联系电话（phone）
   - 功能：存储管理员基本信息

3. **Court（场地类）**
   - 属性：场地编号（courtId）、场地类型（type）、状态（status）
   - 枚举类型：
     - CourtType：SINGLES（单打）、DOUBLES（双打）
     - CourtStatus：AVAILABLE（可用）、MAINTENANCE（维修中）
   - 功能：管理场地信息

4. **Reservation（预约类）**
   - 属性：预约编号（reservationId）、学生学号（studentId）、场地编号（courtId）、开始时间（startTime）、结束时间（endTime）、状态（status）
   - 枚举类型：
     - ReservationStatus：PENDING（待使用）、COMPLETED（已完成）、CANCELLED（已取消）
   - 功能：管理预约信息

#### 工具类设计

**JsonUtil（JSON工具类）**
- 功能：提供JSON文件的读写操作
- 使用Gson库进行JSON序列化和反序列化
- 支持UTF-8编码，确保中文正确显示

#### 数据管理类设计

**DataManager（数据管理器）**
- 设计模式：单例模式
- 功能：
  - 统一管理所有数据的加载和保存
  - 提供数据的增删改查操作
  - 实现预约冲突检测（时间段重叠检测）
- 数据存储位置：data目录下的JSON文件

#### 服务类设计

1. **UserService（用户服务类）**
   - 功能：
     - 学生注册：验证学号唯一性
     - 学生登录：验证学号是否存在
     - 管理员登录：验证工号是否存在
     - 获取用户信息

2. **ReservationService（预约服务类）**
   - 功能：
     - 查询可用场地：支持按时间段查询
     - 预约场地：验证参数、检查冲突、创建预约
     - 取消预约：验证权限和状态
     - 查看我的预约：按学号查询
     - 确认预约完成：管理员操作

3. **CourtService（场地服务类）**
   - 功能：
     - 获取所有场地
     - 添加场地：验证场地编号唯一性
     - 更新场地状态：修改场地可用性

#### 界面类设计

1. **ConsoleUI（控制台界面）**
   - 功能：提供基于命令行的交互界面
   - 特点：简单直观，适合快速操作

2. **SwingUI（图形界面）**
   - 功能：提供基于Swing的图形用户界面
   - 特点：用户体验好，操作便捷
   - 使用CardLayout实现界面切换
   - 使用JTabbedPane组织功能模块

## 三、核心功能设计

### 3.1 用户管理功能

1. **学生注册**
   - 输入：学号、姓名、联系电话
   - 验证：学号不能为空、学号唯一性检查
   - 输出：注册成功或失败信息

2. **学生登录**
   - 输入：学号
   - 验证：学号是否存在
   - 输出：登录成功进入学生功能菜单

3. **管理员登录**
   - 输入：工号
   - 验证：工号是否存在
   - 输出：登录成功进入管理员功能菜单

### 3.2 预约管理功能

1. **查询可用场地**
   - 功能：显示所有状态为"可用"的场地
   - 扩展：支持按时间段查询，排除已被预约的场地

2. **预约场地**
   - 输入：场地编号、开始时间、结束时间
   - 验证：
     - 场地是否存在且可用
     - 时间段是否有效（开始时间早于结束时间）
     - 时间段是否冲突（与其他预约重叠）
     - 不能预约过去的时间
   - 输出：预约成功，返回预约编号

3. **取消预约**
   - 输入：预约编号
   - 验证：
     - 预约是否存在
     - 是否为当前学生的预约
     - 预约状态是否为"待使用"
   - 输出：取消成功

4. **查看我的预约**
   - 功能：显示当前学生的所有预约记录
   - 显示：预约编号、场地编号、时间段、状态

5. **管理员确认预约完成**
   - 输入：预约编号
   - 验证：预约是否存在且状态为"待使用"
   - 输出：确认成功，状态更新为"已完成"

### 3.3 场地管理功能（管理员）

1. **查看所有场地**
   - 功能：显示所有场地的信息

2. **添加场地**
   - 输入：场地编号、场地类型、状态
   - 验证：场地编号唯一性
   - 输出：添加成功

3. **修改场地状态**
   - 输入：场地编号、新状态
   - 验证：场地是否存在
   - 输出：修改成功

## 四、数据存储设计

### 4.1 存储格式

采用JSON格式存储数据，具有以下优点：
- 人类可读，便于调试和维护
- 跨平台兼容性好
- 无需数据库，部署简单

### 4.2 文件结构

```
data/
├── students.json      # 学生数据
├── admins.json        # 管理员数据
├── courts.json        # 场地数据
└── reservations.json  # 预约数据
```

### 4.3 数据持久化策略

- 采用即时保存策略：每次数据修改后立即保存到文件
- 程序启动时自动加载所有数据
- 使用单例模式确保数据一致性

## 五、异常处理设计

系统在关键操作点都进行了异常处理：

1. **参数验证异常**
   - 空值检查
   - 格式验证（时间格式等）

2. **业务逻辑异常**
   - 唯一性检查（学号、场地编号等）
   - 权限验证（取消预约等）
   - 状态检查（预约状态等）

3. **IO异常**
   - 文件读写异常处理
   - 数据加载失败时的容错处理

## 六、界面设计

### 6.1 控制台界面

- 采用菜单式交互
- 清晰的提示信息
- 输入验证和错误提示

### 6.2 图形界面

- 使用Swing组件构建
- CardLayout实现界面切换
- JTabbedPane组织功能模块
- 表格展示数据
- 对话框处理用户输入

## 七、设计模式应用

1. **单例模式**
   - DataManager类采用单例模式，确保数据管理的一致性

2. **分层架构模式**
   - 清晰的层次划分，便于维护和扩展

3. **MVC模式思想**
   - Model（实体类）、View（界面类）、Controller（服务类）

## 八、扩展功能设计（可选）

系统预留了扩展接口，可以轻松添加以下功能：

1. **预约费用计算**
   - 在ReservationService中添加费用计算逻辑
   - 根据时间段和场地类型计算费用

2. **预约冲突检测**
   - 已在DataManager中实现基础的时间段重叠检测
   - 可以扩展更复杂的冲突检测规则

3. **场地综合评分统计**
   - 添加评分实体类
   - 在预约完成后允许学生评分
   - 统计场地的平均评分

4. **不同时段不同收费标准**
   - 添加价格配置类
   - 在预约时根据时间段计算费用

## 九、技术选型

- **开发语言**：Java
- **GUI框架**：Java Swing
- **JSON处理**：Google Gson
- **时间处理**：Java 8 Time API（LocalDateTime）

## 十、总结

本系统采用面向对象的设计思想，通过合理的类设计、分层架构和设计模式的应用，实现了一个功能完整、易于维护和扩展的场地预约管理系统。系统具有良好的用户体验、完善的异常处理和清晰的数据管理机制。

